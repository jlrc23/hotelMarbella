!function(e){e.fn.TSToggleSwitch=function(t){t=t||{};var i=e.extend({drag:!0,click:!0,text:{on:"ON",off:"OFF"},on:!1,animate:250,transition:"ease-in-out",checkbox:null,input:null,clicker:null,width:50,height:20,type:"compact"},t),n="select"==i.type;i.checkbox=e(i.checkbox),i.input=e(i.input),i.clicker&&(i.clicker=e(i.clicker));var s="margin-left "+i.animate+"ms "+i.transition,a={"-webkit-transition":s,"-moz-transition":s,transition:s},r={"-webkit-transition":"","-moz-transition":"",transition:""},o=function(e,t,s,o){var l=e.toggleClass("active").hasClass("active");if(o!==l){var c=e.find(".toggle-inner").css(a);if(e.find(".toggle-off").toggleClass("active"),e.find(".toggle-on").toggleClass("active"),i.checkbox.prop("checked",l).attr("checked",l),i.input.val(l),i.input.trigger("change"),!n){var u=l?0:-t+s;c.css("margin-left",u),setTimeout(function(){c.css(r),c.css("margin-left",u)},i.animate)}}};return this.each(function(){var t=e(this),s=t.height(),a=t.width();s&&a||(t.height(s=i.height),t.width(a=i.width));var r='<div class="toggle-',l=e(r+'slide">'),c=e(r+'inner">'),u=e(r+'on">'),h=e(r+'off">'),d=e(r+'blob">'),p=s/2,f=a-p;if(u.css({height:s,width:f,textAlign:"center",textIndent:n?"":-p,lineHeight:s+"px"}).html(i.text.on),h.css({height:s,width:f,marginLeft:n?"":-p,textAlign:"center",textIndent:n?"":p,lineHeight:s+"px"}).html(i.text.off).addClass("active"),d.css({height:s,width:s,marginLeft:-p}),c.css({width:2*a-s,marginLeft:n?0:-a+s}),n&&(l.addClass("toggle-select"),t.css("width",2*f),d.hide()),t.html(l.html(c.append(u,d,h))),l.on("toggle",function(e,i){e&&e.stopPropagation(),o(l,a,s),t.trigger("toggle",!i)}),t.on("toggleOn",function(){o(l,a,s,!1)}),t.on("toggleOff",function(){o(l,a,s,!0)}),i.on&&o(l,a,s),!i.click||i.clicker&&i.clicker.has(t).length||t.on("click",function(e){e.target==d[0]&&i.drag||l.trigger("toggle",l.hasClass("active"))}),i.clicker&&i.clicker.on("click",function(e){e.target==d[0]&&i.drag||l.trigger("toggle",l.hasClass("active"))}),i.drag&&!n){var m,g=(a-s)/4,y=function(e){t.off("mousemove"),l.off("mouseleave"),d.off("mouseup");var n=l.hasClass("active");return!m&&i.click&&"mouseleave"!==e.type?(l.trigger("toggle",n),void 0):(n?-g>m?l.trigger("toggle",n):c.animate({marginLeft:0},i.animate/2):m>g?l.trigger("toggle",n):c.animate({marginLeft:-a+s},i.animate/2),void 0)},v=-a+s;d.on("mousedown",function(e){m=0,d.off("mouseup"),l.off("mouseleave");var i=e.pageX;t.on("mousemove",d,function(e){m=e.pageX-i;var t;l.hasClass("active")?(t=m,m>0&&(t=0),v>m&&(t=v)):(t=m+v,0>m&&(t=v),m>-v&&(t=0)),c.css("margin-left",t)}),d.on("mouseup",y),l.on("mouseleave",y)})}})}}(jQuery);